# GFW(墙)的封锁方式TCP封锁(阻断)猜想
对于翻墙界来说，2018年真不是个顺利年。从年初的 SSR 停更并删除项目，到后来的数次大规模封禁代理服务器，甚至发展到现在已经成为日常了，几乎每天都有人的代理服务器被墙，经常听到各个群组讨论，也是。。哎！

自从2018年初开始，墙的封锁方式就从 全部协议封锁 改为了 TCP封锁(阻断)，该封锁方式主要特征为:<br>
`Ping IP正常连通(ICMP协议)，而 TCPing IP连接超时无回应(TCP协议)。`
> 脑洞: 这也挺好的，因为相比以前，现在可以更准确的判断服务器被墙，而不是网络、服务器问题了。
以前你发现代理账号连不上了，你会去 Ping ，然后发现 Ping不通，接着你会怀疑是不是网络问题、服务器问题等，然后验证半天后发现：的确是被墙了。

> 而现在，你只需要 Ping IP 一下，TCPing IP 一下，就能肯定是被墙了。

基本上你测试你的服务器 IP 出现这种情况，99%的几率就是被墙了。剩下的 1% 就是防火墙没开放端口之类的配置问题。

### TCP封锁(阻断) 简单解释:
当你的海外服务器 IP 被TCP封锁(阻断)后，你依然可以正常的向海外代理服务器发送数据（客户端连接服务端），但是海外代理服务器上的代理服务端在向你返回数据的时候，肯定是要经过墙的，而墙发现发送者IP(代理服务器)在黑名单中，于是就会阻断、拦截，这样你的客户端就收不到来自服务端的返回数据了（SSR上表现为：超时或空连）。

而目前的代理软件基本都是使用 TCP 协议传输的，而TCP协议要传输数据，则先要进行握手环节，而握手自然要有来有回，所以当墙对海外代理服务器回程TCP阻断的时候，就会导致代理客户端与服务端无法完成握手，自然也无法使用代理了。

### 如何补救？
而目前这种非一锅端的封禁方式，让一些人脑洞大开，比如:
1. 有人把 TCP 协议数据转换为 ICMP 协议数据传输，能用，但是缺陷很明显，速度太慢了，因为协议的限制意味着速度实在快不了多少。。。
2. 有人想 TCP 协议封禁了，那我可以用 UDP 呀，于是就有人尝试 TCP协议 数据转换为 UDP 协议数据传输，目前这类软件都比较成熟了，以前往往都是拿来做加速或者游戏优化用的，而现在拿来正好！
3. 结果发现一些人的IP是 TCP UDP 协议都被封了，而一些人的IP是只封了 TCP协议，这就很迷了。也有人 TCP 协议转成 UDP 协议使用后被封的例子，搞得该方法也无法完全作为被墙IP的补救措施。
4. 而且国内很多运营商往往都会对 UDP QOS限速，而想要解决 UDP QOS限速，你则需要把 UDP协议 伪装成 TCP协议，然而这又是一个死循环了，TCP 协议被阻断。

<b>那么除了上面说的两者有缺陷的，还有没有能复活被墙IP的服务器继续做代理呢？</b>

有的，比如: [Goflyway 的WS+CDN模式](https://doub.io/goflyway-jc3/) 和 V2ray 的WS+CDN模式。

这两种方法都是依赖于CDN，而想要让 CDN 来中转代理，就需要 WebSocket 技术，Goflyway V2ray 都支持 WebSocket。

但光有 WebSocket+CDN 只能算复活被墙IP，无法保证 CDN IP 的安全性(被墙方面)，所以还都需要HTTP、HTTPS伪装。

所以在使用 Goflyway 时往往搭配 HTTP伪装，而使用 V2ray 时往往搭配 HTTP HTTPS伪装。这里 HTTP HTTPS伪装可不是 SS SSR 里的 伪 · HTTP HTTPS伪装，而是实实在在的网站（或者反向代理来的）。

也就是你浏览器打开域名(这种复活方法必须有域名)会看到正常的网页，而代理客户端访问则是建立代理链接。

> 注意: CDN 特别是免费套餐的 CDN，国内链接速度往往不如意，如果不在意 或 当备用的可以搭建试试。

### 如何解封？
有人又会问，IP(IPv4)被墙是永久的吗？会解封吗？

当然会解封，IP(IPv4) 的数量是有限的，封一个就少一个，如果只封不解，那不成貔貅了？

更何况，换位思考想一下，假设你买了一个月付的海外服务器搭建代理，因为什么原因导致被墙了，那么到期的时候，你还会续费下去等待墙解封吗？自然不会，半年付、年付同样。

既然你不会为了等待IP解封而续费下去，那么这个服务器到期后，别人在购买的时候却不一定会是搭建代理的，他可能是正常做网站什么的。

墙考虑到 海外大量的IDC 和 国内购买海外服务器正常使用者 的体验和情绪，那就必须要定期解封。

以前还是全协议封禁的时候，我不清楚墙的解封流程，但是今年换成 TCP协议封锁(阻断) 后，经过实验和大量网友的反馈，能猜个大概了。

每个做代理被墙的海外服务器IP，墙都会根据不同情况设定一个解封时间（根据情况时间可能不同）。

如果解封时间内该海外服务器IP没有向国内发送数据或者尝试建立代理连接，那么墙就会解封该IP。当然解封该IP后不代表就可以继续做代理了，根据实验和大量网友反馈，被解封的海外服务器IP，短时间内再用于代理用途，往往很快就又会封禁（非100%，另外间隔时间越长，理论再次封禁几率越低）。

所以大家应该明白了吧？

如果你的海外服务器 IP 被TCP封禁(阻断)，那么请关闭或者删除服务器上面的代理软件（墙还可能定期对被墙IP的服务器主动探测，所以必须要关闭代理软件。），然后一段时间不理这个服务器，应该就会解封了（不是100%，而且各IP的封禁时间也可能不一样）。


<b>这时候又有人问了：我被墙的海外服务器都吃灰两个月了，怎么还没有解封？</b>

这个问题除了我上面最后说过的几率问题 和 解封时间问题外，还有个可能导致该情况的原因是：你是不是有空没空就去试试代理账号能不能用？或者有事没事 TCPing 测试一下解封了没有？

这个无意的行为，可能会导致墙对你被墙的海外服务器IP 重置解封时间或者说延长解封时间。

> 就是说: 当墙发现你被墙的海外服务器IP向国内发送数据或者尝试建立代理连接时，就可能会重置解封时间或延长解封时间。

> 另外: 墙还可能定期对被墙IP的服务器主动探测，看看代理软件是否还在运行，所以必须要关闭代理软件。

### 如何避免被墙？
目前没有任何一个代理软件可以保证代理服务器IP不会被墙（emmmm 除了 `WS+CDN+伪装` ），顶多减少被墙几率。

以前流行的 SSR 因为已经停更大半年了，没有更新就意味着没办法抵御墙的检测，所以目前不推荐使用了。建议使用 V2ray、Brook、Goflyway 等代理软件。

除了代理软件的选择之外，服务器地区也对被墙几率有很大影响。经过实验和大量网友反馈，目前日本、美国等热门地区均是重灾区，被墙几率远高于其他较冷门地区的服务器，所以不管你当前用的是什么地区的服务器，如果该地区服务器IP频繁被墙，那么你应该考虑使用其他地区的服务器来继续搭建代理了。

最后，总结:
1. Goflyway V2ray 可以复活被墙IP
2. 被墙IP有解封时间概念
3. 被墙IP的服务器，请关闭代理软件并不理服务器一段时间，有几率解封IP
4. 墙可能会定期对被墙IP的服务器主动探测代理，所以必须关闭代理软件
5. 日本、美国等热门地区服务器被墙几率更高，建议避开热门地区

感谢参考: [逗比根据地--->关于目前 GFW(墙) 的封锁方式TCP封锁(阻断)猜想](https://doub.io/sxsx-14/)

<a href="https://www.vultr.com/?ref=7295225"><img src="https://www.vultr.com/media/banner_1.png" width="100%" height="90"></a>